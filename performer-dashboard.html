<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Studio Performer - SMIPRO</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        /* HEADER PROFIL */
        .perf-header { 
            height: 220px; 
            background: linear-gradient(to bottom, #333, #121212), url('https://images.unsplash.com/photo-1501612780327-450456b106f8?q=80&w=1000');
            background-size: cover;
            background-blend-mode: multiply;
            position: relative; 
            display: flex; 
            align-items: end; 
            padding: 20px; 
        }
        
        .perf-pic-container {
            width: 100px; height: 100px;
            margin-right: 20px;
            position: relative;
            z-index: 5;
            cursor: pointer;
            margin-bottom: 10px;
        }
        .perf-pic { 
            width: 100%; height: 100%; 
            border-radius: 50%; object-fit: cover; 
            box-shadow: 0 0 20px rgba(0,0,0,0.5); 
            border: 4px solid var(--accent); 
            background:#000; 
        }
        .edit-badge {
            position: absolute; bottom: 5px; right: 5px;
            background: var(--primary); color: white;
            width: 30px; height: 30px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            border: 2px solid white; font-size: 0.8rem;
            transition: 0.3s;
        }
        .perf-pic-container:hover .edit-badge { transform: scale(1.1); background: var(--accent); color: black; }

        .perf-info { z-index: 2; }
        .perf-info h1 { margin: 0; font-size: 1.8rem; color: white; }
        .perf-info p { color: #ccc; margin: 5px 0; font-size:0.9rem; }
        .verified-badge { background: #1a3320; color: #4ade80; padding: 4px 10px; border-radius: 15px; font-size: 0.7rem; display: inline-flex; align-items: center; gap: 5px; border: 1px solid #4ade80; margin-bottom:5px; }

        .header-logo-corner { position: absolute; top: 15px; left: 15px; width: 50px; z-index: 10; filter: drop-shadow(0 0 5px rgba(0,0,0,0.8)); }
        .header-nav-corner { position: absolute; top: 15px; right: 15px; display: flex; gap: 10px; z-index: 10; }
        .btn-nav-header { background: rgba(0,0,0,0.6); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 6px 12px; border-radius: 5px; cursor: pointer; font-size: 0.8rem; display: flex; align-items: center; gap: 5px; transition: 0.3s; }
        .btn-nav-header:hover { background: rgba(255,255,255,0.2); }
        .btn-logout { background: rgba(229, 9, 20, 0.8); border: none; }
        .btn-logout:hover { background: #E50914; }

        .mitra-tabs { display: flex; justify-content: space-around; background: #111; border-bottom: 1px solid #333; margin-bottom: 20px; }
        .tab-btn { flex: 1; padding: 15px; background: none; border: none; color: #888; font-weight: bold; cursor: pointer; border-bottom: 3px solid transparent; }
        .tab-btn.active { color: white; border-bottom-color: var(--accent); }
        
        .tab-content { display: none; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        .track-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; margin-top: 20px; }
        .track-card { background: #181818; padding: 15px; border-radius: 8px; transition: 0.3s; cursor: pointer; border: 1px solid transparent; position: relative; }
        .track-card:hover { background: #282828; border-color: #444; }
        .track-img { width: 100%; aspect-ratio: 1/1; object-fit: cover; border-radius: 5px; margin-bottom: 10px; background: #333; }
        .track-title { font-weight: bold; color: white; font-size: 0.9rem; margin-bottom: 5px; display: block; }
        .track-type { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 1px; color: #aaa; }
        .play-icon { position: absolute; bottom: 80px; right: 20px; background: var(--green); color: black; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; opacity: 0; transition: 0.3s; box-shadow: 0 5px 10px rgba(0,0,0,0.5); }
        .track-card:hover .play-icon { opacity: 1; bottom: 90px; }

        .doc-item { display: flex; align-items: center; background: #222; padding: 15px; border-radius: 10px; margin-bottom: 10px; border: 1px solid #444; }
        .doc-icon { font-size: 2rem; color: var(--primary); margin-right: 15px; }
        .btn-action-doc { background: #333; border: 1px solid #555; color: white; padding: 5px 15px; border-radius: 20px; cursor: pointer; margin-left: 5px; font-size:0.8rem; }
        .btn-action-doc:hover { background: var(--accent); color: black; border-color:var(--accent); }

        .rating-summary { background: linear-gradient(135deg, #1a1a1a 0%, #000 100%); padding: 20px; border-radius: 15px; border: 1px solid var(--accent); text-align: center; margin-bottom: 20px; }
        .rating-big { font-size: 3rem; font-weight: 800; color: var(--accent); line-height: 1; }
        .review-card { background: #222; padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid #444; }
        .review-header { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 0.9rem; color: #ccc; }
        .review-text { font-style: italic; color: white; font-size: 0.95rem; }
    </style>
</head>
<body>

    <!-- 1. HEADER PROFIL -->
    <div class="perf-header">
        <img src="https://raw.githubusercontent.com/sekolakonangindonesia-prog/smipro-streetart/main/Logo_Stretart.png" class="header-logo-corner" alt="Logo">

        <div class="header-nav-corner">
            <button onclick="location.href='index.html'" class="btn-nav-header" id="nav-home-btn"><i class="fa-solid fa-house"></i> Home</button>
            <button onclick="prosesLogout()" class="btn-nav-header btn-logout"><i class="fa-solid fa-right-from-bracket"></i> Logout</button>
        </div>

        <div class="perf-pic-container" onclick="triggerUpload()">
            <img src="https://images.unsplash.com/photo-1570295999919-56ceb5ecca61?q=80&w=300" class="perf-pic" id="header-profile-img">
            <div class="edit-badge"><i class="fa-solid fa-camera"></i></div>
        </div>

        <div class="perf-info">
            <div class="verified-badge"><i class="fa-solid fa-circle-check"></i> Certified Performer</div>
            <h1>The Acoustic Boys</h1>
            <p>ID: SMIPRO-024 ‚Ä¢ Pop Jawa & Koplo</p>
        </div>
    </div>

    <!-- 2. TAB MENU -->
    <div class="mitra-tabs">
        <button class="tab-btn active" onclick="switchTab('galeri')">üéµ Galeri</button>
        <button class="tab-btn" onclick="switchTab('dokumen')">üìÑ Dokumen</button>
        <button class="tab-btn" onclick="switchTab('ulasan')">‚≠ê Ulasan</button>
        <button class="tab-btn" onclick="switchTab('profil')">‚öôÔ∏è Profil</button>
    </div>

    <div class="container">
        <input type="file" id="file-input" style="display:none;" accept="image/*" onchange="previewImage(this)">

        <!-- TAB 1: GALERI (BARU) -->
        <div id="tab-galeri" class="tab-content active">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <div>
                    <h3 style="color:var(--accent); margin-top:0;">Rekaman Performance</h3>
                    <p style="color:#888; font-size:0.9rem; margin-top:-5px;">Dokumentasi hasil editing.</p>
                </div>
                <!-- TOMBOL KHUSUS ADMIN/MENTOR -->
                <button id="btn-add-gallery" onclick="openAddModal()" style="display:none; background:var(--primary); color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer; font-weight:bold;">
                    <i class="fa-solid fa-plus"></i> Tambah Konten
                </button>
            </div>

            <!-- Grid Galeri Dinamis -->
            <div class="track-grid" id="gallery-container">
                <p style="color:#666;">Memuat galeri...</p>
            </div>
        </div>

        <!-- TAB 2: DOKUMEN -->
        <div id="tab-dokumen" class="tab-content">
            <h3>Dokumen Legalitas</h3>
            <div class="doc-item">
                <i class="fa-solid fa-certificate doc-icon"></i>
                <div style="flex:1;"><b>Sertifikat Lulus Bengkel</b><br><small style="color:#aaa;">20 Des 2025</small></div>
                <button class="btn-action-doc" onclick="openModalDoc('Sertifikat')"><i class="fa-regular fa-eye"></i> Lihat</button>
                <button class="btn-action-doc" onclick="downloadFile('Sertifikat_Lulus_Bengkel.pdf')"><i class="fa-solid fa-download"></i> Unduh</button>
            </div>
            <div class="doc-item" style="border-color:var(--primary);">
                <i class="fa-solid fa-file-contract doc-icon"></i>
                <div style="flex:1;"><b>MOU Kontrak Management</b><br><small style="color:var(--primary);">AKTIF s/d Des 2026</small></div>
                <button class="btn-action-doc" onclick="openModalDoc('MOU')"><i class="fa-regular fa-eye"></i> Lihat</button>
                <button class="btn-action-doc" onclick="downloadFile('MOU_Kontrak_Kerja_Sama.pdf')"><i class="fa-solid fa-download"></i> Unduh</button>
            </div>
            <div style="background:#332b00; padding:15px; border-radius:10px; margin-top:20px; color:#ffeb3b; font-size:0.9rem;">
                <i class="fa-solid fa-triangle-exclamation"></i> <b>PERHATIAN:</b><br>
                Sesuai MOU Pasal 3, dilarang tampil komersial di luar management tanpa izin.
            </div>
        </div>

        <!-- TAB 3: ULASAN -->
        <div id="tab-ulasan" class="tab-content">
            <div class="rating-summary">
                <div class="rating-big">4.8</div>
                <div style="color:gold; margin:5px 0;"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star-half-stroke"></i></div>
                <small style="color:#aaa;">Berdasarkan 128 Ulasan Penonton</small>
            </div>
            <h3 style="margin-bottom:15px;">Komentar Terbaru</h3>
            <div class="review-card">
                <div class="review-header"><span><i class="fa-solid fa-user"></i> Budi Santoso</span><span style="color:gold;">‚òÖ 5.0</span></div>
                <div class="review-text">"Gokil suaranya! Lagu Nemen-nya bikin ambyar. Sukses terus mas!"</div>
            </div>
        </div>

        <!-- TAB 4: PROFIL (UPDATE SOSMED) -->
        <div id="tab-profil" class="tab-content">
            <div style="background:#222; padding:20px; border-radius:10px; border:1px solid #333;">
                <h3 style="margin-top:0; color:#E50914;">Edit Profil & Sosmed</h3>
                
                <!-- FOTO -->
                <div style="text-align:center; margin-bottom:20px; padding:15px; border:1px dashed #444; border-radius:10px;">
                    <img src="" id="preview-profile-img" style="width:80px; height:80px; border-radius:50%; object-fit:cover; margin-bottom:10px; border:2px solid #555;">
                    <br>
                    <button class="btn-nav-header" onclick="triggerUpload()" style="margin:0 auto; background:#333;">
                        <i class="fa-solid fa-camera"></i> Ganti Foto Profil
                    </button>
                </div>

                <!-- INFO DASAR -->
                <label style="color:#aaa; font-size:0.8rem;">Nama Panggung (Sesuai Kontrak)</label>
                <input type="text" id="edit-name" style="width:100%; padding:10px; background:#111; border:1px solid #444; color:white; margin-bottom:15px; border-radius:5px;" readonly title="Hubungi Admin untuk ubah nama">
                
                <label style="color:#aaa; font-size:0.8rem;">Bio Singkat</label>
                <textarea id="edit-bio" style="width:100%; padding:10px; background:#111; border:1px solid #444; color:white; margin-bottom:15px; border-radius:5px; height:80px;" placeholder="Deskripsikan gaya musikmu..."></textarea>

                <!-- SOSIAL MEDIA -->
                <h4 style="color:#888; border-bottom:1px solid #444; padding-bottom:5px;">Tautan Sosial Media</h4>
                
                <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px;">
                    <i class="fa-brands fa-instagram" style="color:#C13584; width:20px;"></i>
                    <input type="text" id="edit-ig" placeholder="Link Instagram (https://...)" style="flex:1; padding:10px; background:#111; border:1px solid #444; color:white; border-radius:5px;">
                </div>

                <div style="display:flex; align-items:center; gap:10px; margin-bottom:10px;">
                    <i class="fa-brands fa-tiktok" style="color:#00f2ea; width:20px;"></i>
                    <input type="text" id="edit-tiktok" placeholder="Link TikTok" style="flex:1; padding:10px; background:#111; border:1px solid #444; color:white; border-radius:5px;">
                </div>

                <div style="display:flex; align-items:center; gap:10px; margin-bottom:20px;">
                    <i class="fa-brands fa-youtube" style="color:#ff0000; width:20px;"></i>
                    <input type="text" id="edit-yt" placeholder="Link Channel YouTube" style="flex:1; padding:10px; background:#111; border:1px solid #444; color:white; border-radius:5px;">
                </div>

                <button style="background:var(--primary); color:white; border:none; padding:12px; width:100%; border-radius:5px; font-weight:bold; cursor:pointer; font-size:1rem;" onclick="saveProfileData()">
                    <i class="fa-solid fa-floppy-disk"></i> SIMPAN PERUBAHAN
                </button>
            </div>
        </div>

    <!-- MODAL VIEW DOKUMEN -->
    <div id="modal-doc" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.9); z-index:2000; align-items:center; justify-content:center; padding:20px;">
        <div style="background:#fff; width:100%; max-width:500px; height:80vh; padding:20px; border-radius:10px; position:relative; display:flex; flex-direction:column;">
            <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                <h3 style="margin:0; color:black;" id="doc-title">Preview Dokumen</h3>
                <button onclick="document.getElementById('modal-doc').style.display='none'" style="border:none; background:none; font-size:1.5rem; cursor:pointer; color:black;">&times;</button>
            </div>
            <div style="flex:1; background:#eee; display:flex; align-items:center; justify-content:center; border:1px solid #ccc;">
                <p style="color:#555;">[Simulasi View PDF]</p>
            </div>
        </div>
    </div>

    <!-- === TOMBOL KHUSUS ADMIN === -->
    <div id="admin-floating-btn" style="display:none; position:fixed; bottom:20px; right:20px; z-index:9999;">
        <button onclick="backToAdminDashboard()" style="background:#E50914; color:white; padding:12px 20px; border:2px solid white; border-radius:30px; font-weight:bold; cursor:pointer; box-shadow:0 5px 20px rgba(0,0,0,0.8); display:flex; align-items:center; gap:10px;">
            <i class="fa-solid fa-user-shield"></i> KEMBALI KE ADMIN
        </button>
    </div>

    <!-- MODAL INPUT GALERI (ADMIN ONLY) -->
    <div id="modal-add-gallery" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.9); z-index:3000; align-items:center; justify-content:center; padding:20px;">
        <div style="background:#222; width:100%; max-width:400px; padding:20px; border-radius:10px; border:1px solid #444;">
            <h3 style="margin-top:0; color:white;">Tambah Galeri</h3>
            
            <label style="color:#aaa; font-size:0.8rem;">Judul Lagu/Video</label>
            <input type="text" id="add-title" style="width:100%; padding:10px; background:#111; border:1px solid #444; color:white; margin-bottom:10px; border-radius:5px;">

            <label style="color:#aaa; font-size:0.8rem;">Tipe Konten</label>
            <select id="add-type" style="width:100%; padding:10px; background:#111; border:1px solid #444; color:white; margin-bottom:10px; border-radius:5px;">
                <option value="video">Video (YouTube)</option>
                <option value="audio">Audio (MP3 Link)</option>
            </select>

            <label style="color:#aaa; font-size:0.8rem;">Link URL</label>
            <input type="text" id="add-url" placeholder="YouTube / MP3 Link" style="width:100%; padding:10px; background:#111; border:1px solid #444; color:white; margin-bottom:10px; border-radius:5px;">

            <label style="color:#aaa; font-size:0.8rem;">Link Thumbnail (Opsional)</label>
            <input type="text" id="add-thumb" placeholder="https://..." style="width:100%; padding:10px; background:#111; border:1px solid #444; color:white; margin-bottom:20px; border-radius:5px;">

            <div style="display:flex; gap:10px;">
                <button onclick="document.getElementById('modal-add-gallery').style.display='none'" style="flex:1; padding:10px; background:#444; border:none; color:white; border-radius:5px; cursor:pointer;">Batal</button>
                <button onclick="saveGalleryItem()" style="flex:1; padding:10px; background:var(--primary); border:none; color:white; border-radius:5px; cursor:pointer;">Simpan</button>
            </div>
        </div>
    </div>

    <!-- MODAL PLAYER -->
    <div id="modal-player" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.95); z-index:4000; flex-direction:column; align-items:center; justify-content:center; padding:20px;">
        <button onclick="closePlayer()" style="position:absolute; top:20px; right:20px; background:none; border:none; color:white; font-size:2rem; cursor:pointer;">&times;</button>
        <div id="player-content" style="width:100%; max-width:800px; text-align:center;"></div>
    </div>

    <script>
        // DATA DUMMY (Bisa dihapus jika sudah connect DB)
        let galleryData = [
            { id: 1, type: 'video', title: 'Live Performance', url: 'https://www.youtube.com/embed/dQw4w9WgXcQ', thumb: 'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?q=80&w=300' },
            { id: 2, type: 'audio', title: 'Cover Lagu Nemen', url: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3', thumb: 'https://images.unsplash.com/photo-1493225255756-d9584f8606e9?q=80&w=300' }
        ];

        window.onload = function() {
            const role = localStorage.getItem('userRole'); 
            const isAdmin = localStorage.getItem('adminOrigin') === 'true';
            const navBtn = document.getElementById('nav-home-btn');

            // 1. CEK HAK AKSES TOMBOL UPLOAD
            if (isAdmin || role === 'mentor') {
                document.getElementById('btn-add-gallery').style.display = 'block';
            }

            // 2. NAVIGASI MENTOR
            if(role === 'mentor') {
                navBtn.innerHTML = '<i class="fa-solid fa-arrow-left"></i> Kembali ke Mentor';
                navBtn.onclick = function(e) { e.preventDefault(); window.location.href = 'mentor-dashboard.html'; };
            }

            // 3. NAVIGASI ADMIN
            if (isAdmin) {
                document.getElementById('admin-floating-btn').style.display = 'block';
                setTimeout(() => {
                    const oldBtn = document.getElementById('nav-home-btn');
                    if (oldBtn && role !== 'mentor') {
                        const newBtn = oldBtn.cloneNode(true);
                        newBtn.innerHTML = '<i class="fa-solid fa-house"></i> Home (Super Admin)';
                        newBtn.onclick = function(e) {
                            e.preventDefault(); e.stopPropagation();
                            if(confirm("Kembali ke Home sebagai SUPER ADMIN?")) {
                                localStorage.setItem('userRole', 'admin');
                                localStorage.setItem('userName', 'Super Admin');
                                localStorage.setItem('userLink', 'admin-dashboard.html'); 
                                window.location.href = 'index.html';
                            }
                        };
                        oldBtn.parentNode.replaceChild(newBtn, oldBtn);
                    }
                }, 500);
            }

            // 4. LOAD GALERI
            loadGallery();
        };

        function loadGallery() {
            const container = document.getElementById('gallery-container');
            container.innerHTML = '';
            
            const storedData = localStorage.getItem('perf_gallery');
            if(storedData) { galleryData = JSON.parse(storedData); }

            galleryData.forEach(item => {
                let icon = item.type === 'video' ? 'fa-video' : 'fa-music';
                let typeText = item.type === 'video' ? 'Video Full' : 'Audio MP3';
                
                container.innerHTML += `
                <div class="track-card" onclick="playMedia('${item.type}', '${item.url}')">
                    <img src="${item.thumb || 'https://via.placeholder.com/150'}" class="track-img">
                    <div class="play-icon"><i class="fa-solid fa-play"></i></div>
                    <span class="track-title">${item.title}</span>
                    <span class="track-type"><i class="fa-solid ${icon}"></i> ${typeText}</span>
                </div>`;
            });
        }

        function openAddModal() { document.getElementById('modal-add-gallery').style.display = 'flex'; }

        function saveGalleryItem() {
            const title = document.getElementById('add-title').value;
            const type = document.getElementById('add-type').value;
            let url = document.getElementById('add-url').value;
            const thumb = document.getElementById('add-thumb').value;

            if(!title || !url) return alert("Isi Judul & Link!");

            // Fix YouTube Link
            if(type === 'video' && url.includes('watch?v=')) {
                url = url.replace('watch?v=', 'embed/');
            } else if (type === 'video' && url.includes('youtu.be/')) {
                url = url.replace('youtu.be/', 'www.youtube.com/embed/');
            }

            const newItem = { id: Date.now(), type, title, url, thumb: thumb || 'https://via.placeholder.com/300?text=No+Img' };
            galleryData.push(newItem);
            localStorage.setItem('perf_gallery', JSON.stringify(galleryData));

            alert("Konten Ditambahkan!");
            document.getElementById('modal-add-gallery').style.display = 'none';
            loadGallery();
            
            document.getElementById('add-title').value = '';
            document.getElementById('add-url').value = '';
        }

        function playMedia(type, url) {
            const modal = document.getElementById('modal-player');
            const content = document.getElementById('player-content');
            modal.style.display = 'flex';

            if(type === 'video') {
                content.innerHTML = `<iframe width="100%" height="450" src="${url}" frameborder="0" allowfullscreen style="border-radius:10px;"></iframe>`;
            } else {
                content.innerHTML = `
                    <div style="background:#222; padding:30px; border-radius:15px; border:1px solid #444;">
                        <i class="fa-solid fa-music fa-4x" style="color:var(--primary); margin-bottom:20px;"></i>
                        <h3 style="color:white;">Now Playing</h3>
                        <audio controls autoplay style="width:100%; margin-top:20px;">
                            <source src="${url}" type="audio/mpeg">
                        </audio>
                    </div>`;
            }
        }

        function closePlayer() {
            document.getElementById('modal-player').style.display = 'none';
            document.getElementById('player-content').innerHTML = '';
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(e => e.style.display = 'none');
            document.querySelectorAll('.tab-btn').forEach(e => e.classList.remove('active'));
            document.getElementById('tab-' + tabId).style.display = 'block';
            event.currentTarget.classList.add('active');
        }

        function openModalDoc(t) { document.getElementById('doc-title').innerText=t; document.getElementById('modal-doc').style.display='flex'; }
        function downloadFile(f) { alert("Download simulasi: "+f); }
        function triggerUpload() { document.getElementById('file-input').click(); }
        function previewImage(i) { if(i.files[0]) { var r = new FileReader(); r.onload=e=>document.getElementById('header-profile-img').src=e.target.result; r.readAsDataURL(i.files[0]); } }
        function prosesLogout() { if(confirm("Logout?")) { localStorage.clear(); window.location.href='index.html'; } }
        function backToAdminDashboard() { if(confirm("Kembali ke Admin?")) { localStorage.setItem('userRole','admin'); localStorage.setItem('userName','Super Admin'); localStorage.setItem('userLink','admin-dashboard.html'); window.location.href='admin-dashboard.html'; } }
    </script>
</body>
</html>
